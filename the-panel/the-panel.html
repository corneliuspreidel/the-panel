<polymer-element name="the-panel" attributes="edge size">
  <template>
    <style>
      @host {
        :scope {
          position: fixed;
          transition: width 1s ease-in-out, height 1s ease-in-out;
          overflow: hidden;
        }
      }
    </style>
    <content select="header"></content>
    <content select="main"></content>
    <content select="footer"></content>
  </template>
  <script>
    Polymer('the-panel', {
      edge: 'left',
      size: 200,
      enteredView: function () {
        this.observe();
        this.updateLocation();
        this.updateVisibility();
      },
      leftView: function () {
        if (this.observer) {
          this.observer.disconnect();
        }
      },
      getMain: function () {
        return this.querySelector('main');
      },
      observe: function () {
        this.observer = new MutationObserver(this.updateVisibility.bind(this));
        this.observer.observe(this.getMain(), {
          subtree: false,
          childList: true,
          attributes: false,
          characterData: false
        });
      },
      getPositionDimension: function () {
        return this.edge;
      },
      getSizeDimensions: function () {
        switch (this.edge) {
          case 'left':
          case 'right':
            return ['width', 'height'];
          case 'top':
          case 'bottom':
            return ['height', 'width'];
        }
      },
      updateLocation: function () {
        this.style.left = '';
        this.style.right = '';
        this.style.top = '';
        this.style.bottom = '';
        this.style[this.getPositionDimension()] = '0px';
      },
      updateVisibility: function () {
        var sizeDimensions = this.getSizeDimensions();
        this.style[sizeDimensions[1]] = '100%';
        if (this.getMain().childElementCount > 0) {
          this.style[sizeDimensions[0]] = this.size + 'px';
        } else {
          this.style[sizeDimensions[0]] = '0px';
        }
      }
    });
  </script>
</polymer-element>
